# Define the path for the input JSON file
$inputJsonFile = "C:\path\to\input.json"

# Load JSON data from the file
$jsonData = Get-Content -Path $inputJsonFile -Raw | ConvertFrom-Json

# Check if the JSON data is an array (PowerShell 5.1 handles JSON slightly differently)
if ($jsonData -is [System.Collections.ArrayList] -or $jsonData -is [Array]) {
    # Sort the JSON objects by multiple keys (e.g., 'age' and 'name')
    $sortedData = $jsonData | Sort-Object -Property age, name
} else {
    Write-Host "Error: The JSON root element is not an array."
    exit
}

# Convert the sorted data back to JSON format
$sortedJson = $sortedData | ConvertTo-Json -Compress

# Define the path for the output JSON file
$outputJsonFile = "C:\path\to\sorted_output.json"

# Write the sorted JSON data to an output file
$sortedJson | Out-File -FilePath $outputJsonFile

# Output a message indicating the sorting is complete
Write-Host "JSON sorting complete. Sorted data saved to $outputJsonFile"
